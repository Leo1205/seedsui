<!doctype html>
<html>
<head>
	<meta charset="utf-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
	<meta name="format-detection" content="telephone=no">
	<title>section</title>
	<link rel="stylesheet" href="../scripts/lib/seedsui/seedsui.min.css">
	<style type="text/css">
	.button{
		margin:8px;
	}
	</style>
</head>

<body ontouchstart="">
	<section id="ID-Page0">
		<header>
		  <div class="titlebar">
		    <a class="titlebar-button" href="javascript:history.go(-1)">
	            <i class="icon icon-arrowleft"></i>
	        </a>
		    <h1 class="titlebar-title">单页模式</h1>
		  </div>
		</header>
		<article>
			<a class="button block bg-1" href="#ID-Page1">slideLeft</a>
		    <a class="button block bg-2" href="#ID-Page2">slideRight</a>
		    <a class="button block bg-3" href="#ID-Page3">slideUp</a>
		    <a class="button block bg-4" href="#ID-Page4">slideDown</a>
		    <a class="button block bg-5" href="#ID-Page5">fade</a>
		    <a class="button block bg-6" href="#ID-Page6">zoom</a>
		    <a class="button block bg-7" href="#ID-Page7">none</a>
		    <!-- <a type="button"style="margin:8px" class="button block bg-8" onclick="openPage('#ID-Page2')">用JS打开打二页</a> -->
		    <div class="card" style="padding:8px;">
		    	因为用到了popstate，涉及到跨域的问题，所以此页面需要在服务器上运行
		    </div>
		    <div class="card" style="padding:8px;">
		    	适用于简单的单页处理，如需要大量使用单页模式，还请使用专业的backbone router或者angularjs router框架处理单页。
		    </div>
		</article>
	</section>
	<!--page1-->
	<section id="ID-Page1" data-animation="slideLeft">
		<header>
		  <div class="titlebar">
		    <a class="titlebar-button" href="javascript:back()">
	            <i class="icon icon-arrowleft"></i>
	        </a>
		    <h1 class="titlebar-title">slideLeft</h1>
		  </div>
		</header>
		<article>
			<a class="button block bg-1 SID-BtnSelf" data-href="#ID-Page1-Page1" target="_self">_self打开</a>
			<a class="button block bg-2" href="#ID-Page1-Page1">普通打开</a>
		</article>
	</section>
	<!--page1_close-->
	<section id="ID-Page1-Page1" data-animation="slideLeft">
		<header>
		  <div class="titlebar">
		    <a class="titlebar-button" href="javascript:back()">
	            <i class="icon icon-arrowleft"></i>
	        </a>
		    <h1 class="titlebar-title">slideLeft</h1>
		  </div>
		</header>
		<article>
			Close页面
		</article>
	</section>
	<!--page2-->
	<section id="ID-Page2" data-animation="slideRight">
		<header>
		  <div class="titlebar">
		    <a class="titlebar-button" href="javascript:back()">
	            <i class="icon icon-arrowleft"></i>
	        </a>
		    <h1 class="titlebar-title">slideRight</h1>
		  </div>
		</header>
		<article>
			slideRight
		</article>
	</section>
	<!--page3-->
	<section id="ID-Page3" data-animation="slideUp">
		<header>
		  <div class="titlebar">
		    <a class="titlebar-button" href="javascript:back()">
	            <i class="icon icon-arrowleft"></i>
	        </a>
		    <h1 class="titlebar-title">slideUp</h1>
		  </div>
		</header>
		<article>
			slideUp
		</article>
	</section>
	<!--page4-->
	<section id="ID-Page4" data-animation="slideDown">
		<header>
		  <div class="titlebar">
		    <a class="titlebar-button" href="javascript:back()">
	            <i class="icon icon-arrowleft"></i>
	        </a>
		    <h1 class="titlebar-title">slideDown</h1>
		  </div>
		</header>
		<article>
			slideDown
		</article>
	</section>
	<!--page5-->
	<section id="ID-Page5" data-animation="fade">
		<header>
		  <div class="titlebar">
		    <a class="titlebar-button" href="javascript:back()">
	            <i class="icon icon-arrowleft"></i>
	        </a>
		    <h1 class="titlebar-title">fade</h1>
		  </div>
		</header>
		<article>
			fade
		</article>
	</section>
	<!--page6-->
	<section id="ID-Page6" data-animation="zoom">
		<header>
		  <div class="titlebar">
		    <a class="titlebar-button" href="javascript:back()">
	            <i class="icon icon-arrowleft"></i>
	        </a>
		    <h1 class="titlebar-title">zoom</h1>
		  </div>
		</header>
		<article>
			zoom
		</article>
	</section>
	<!--page7-->
	<section id="ID-Page7" data-animation="none">
		<header>
		  <div class="titlebar">
		    <a class="titlebar-button" href="javascript:back()">
	            <i class="icon icon-arrowleft"></i>
	        </a>
		    <h1 class="titlebar-title">none</h1>
		  </div>
		</header>
		<article>
			none
		</article>
	</section>
    <script src="../scripts/lib/seedsui/seedsui.min.js"></script>
	<script>
		var view={
            /*=========================
              Model
              ===========================*/
            initialize:function(){
                /*DOM*/
                /*Plugin*/
                this.sections={};
                this.history={};
                /*Data*/

                /*Render*/
                this.render();
                
                /*Events*/
                this._attach();
            },
            render:function(){
                this._initPlugin();
            },
            /*=========================
              Method
              ===========================*/
            _update:function(){
            },
            /*=========================
              Plugin
              ===========================*/
            _initSection:function(){
            	this.sections=new Sections({
                	onStart:function(e){
                		//console.log("开始显示："+e.container.id);
                	},
                	onShowed:function(e){
                		//console.log("显示完成："+e.container.id);
                	},
                	onHid:function(e){
                		//console.log("隐藏完成："+e.container.id);
                	}
                });
            },
            _initHistory:function(){
            	this.history=new History({
                	onBack:function(e){
                		console.log("后退："+e.prevHash);
                		if(e.prevHash)document.querySelector(e.prevHash).classList.remove("active");
                		if(e.currentHash)document.querySelector(e.currentHash).classList.add("active");
                	},
                	onForward:function(e){
                		console.log("前进："+e.currentHash);
                		document.querySelector(e.currentHash).classList.add("active");
                	}
                });
                //初始化时，历史记录就有了，说明刷新过了
                if(this.history.list.length>0){
                	for(var i=0,hash;hash=this.history.list[i++];){
                		document.querySelector(hash).classList.add("active");
                	}
                }
            },
            _initPlugin:function(){
            	this._initSection();
            	this._initHistory();
            },
            /*=========================
              Events
              ===========================*/
            _attach:function(e){
                var self=this;
                document.querySelector(".SID-BtnSelf").addEventListener("click",this._onClickBtnSelf,false);
            },
            /*=========================
              Event Handler
              ===========================*/
            _onClickBtnSelf:function(e){
            	var href=this.getAttribute("data-href");
            	view.history.replace(href);
            	document.querySelector(href).classList.add("active");
        		setTimeout(function(){
        			document.querySelector(view.history.prevHash).classList.remove("active");
        		},500);
        		
            },
        }

        window.addEventListener("load",function(){
            view.initialize();
        }, false);

        //定义exmobi返回
        function back(){history.go(-1);}
	</script>
</body>
</html>